<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=check_circle" />
    <!--v2-->
    <!--<script src="https://www.google.com/recaptcha/api.js" async defer></script>-->
    <!--v3-->
    <script src="https://www.google.com/recaptcha/api.js?render=6LfwcrwmAAAAABmMABASDoYJNXJK2DjgPbSVV3xn"></script>
    <link href="https://js.recurly.com/v4/recurly.css" rel="stylesheet" type="text/css">
    <link href="https://yaronkadstorage.blob.core.windows.net/publiccontainer/izzycheckout/style.css" rel="stylesheet" type="text/css">
    <!--<link rel="stylesheet" href="/Style.css">-->
    <!--<link href="/css/style.css" rel="stylesheet" type="text/css">-->
    <title>Checkout for {planDetails.Name}</title>

</head>
<!--<header>
  Meta Pixel Code Tracking
 <script>
     !function(f,b,e,v,n,t,s)
     {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
     n.callMethod.apply(n,arguments):n.queue.push(arguments)};
     if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
     n.queue=[];t=b.createElement(e);t.async=!0;
     t.src=v;s=b.getElementsByTagName(e)[0];
     s.parentNode.insertBefore(t,s)}(window,document,'script',
     'https://connect.facebook.net/en_US/fbevents.js');
     fbq('init', '2984319098536175'); 
     fbq('track', 'PageView');
   </script>
   <noscript>
    <img height="1" width="1" 
   src="https://www.facebook.com/tr?id=2984319098536175&ev=PageView
   &noscript=1"/>
   </noscript> 
  </header>
    End Meta Pixel Code-->
<body>
    <!--<h1>Checkout for {{PlanName}}</h1>
    <p>Price: {{PlanPriceForDisplay}}</p>-->

    <div class="container mt-5">
        <div class="row">
            <div class="col-lg-6">
                <form id="payment-form" action="/api/IzzyCheckoutApi/process-payment" method="POST">
                    <!--v3-->
                    <input type="hidden" name="g-recaptcha-response" id="g-recaptcha-response">
                    <img class="center" src="https://yaronkadstorage.blob.core.windows.net/publiccontainer/izzycheckout/IZZY_Logo_HQ_STREAMISRAELTV_whole_white_small.png" alt="logo" width="300">
                    <!-- <img class="center" src="https://yaronkadstorage.blob.core.windows.net/publiccontainer/izzycheckout/IZZY%20Logo%20HQ%20STREAMISRAELTV%20black.png" alt="logo" width="300">-->
                    <h5 class="subtitle">Discover the magic of Israel storytelling</h5>
                    <h6 class="subtitle-II">Create your account with a valid email and get access to our content.</h6>

                    <label for="first_name">First Name:</label>
                    <input type="text" id="first_name" name="first_name" data-recurly="first_name" required>

                    <label for="last_name">Last Name:</label>
                    <input type="text" id="last_name" name="last_name" data-recurly="last_name" required>

                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" data-recurly="email" required>

                    <div class="row">
                        <div class="col">
                            <label for="street_address">Street Address:</label>
                            <input type="text" id="street_address" name="street_address" data-recurly="address1" required>
                        </div>
                        <div class="col">
                            <!--<div class="input-control">-->
                            <label for="city">City:</label>
                            <input type="text" id="city" name="city" data-recurly="city" required>
                            <!-- <div class="error"></div>
                    </div>-->
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            <label for="state">State:</label>
                            <input type="text" id="state" name="state" data-recurly="state" required>
                        </div>
                        <div class="col">
                            <label for="zip_code">ZIP/Postal Code:</label>
                            <input type="text" id="zip_code" name="zip_code" data-recurly="postal_code" required>
                        </div>
                    </div>

                    <label for="country">Country:</label>
                    <select id="country" name="country" data-recurly="country" required>
                        <option value="">Select your country</option>
                        <option value="US">United States</option>
                        <option value="CA">Canada</option>
                        <option value="GB">United Kingdom</option>
                        <option value="AU">Australia</option>
                        <option value="IN">India</option>

                        <!-- Add more countries as needed -->
                    </select>

                    <label for="coupon">Coupon Code:</label>
                    <input type="text" id="coupon" name="coupon_code" data-recurly="coupon" placeholder="Enter coupon code">
                    <button type="button" id="apply-coupon">Apply Coupon</button>
                    <p id="coupon-message"></p>

                    <h3 id="summery">Summary:</h3>
                    <p class="payment-detail">Original Price: <span id="original-price">{{PlanPriceForDisplay}}</span></p>
                    <!--<p>Original Price: $<span id="original-price">{{planPriceAsDecimal}}</span></p>-->
                    <p class="payment-detail">Discount: $<span id="discount">0</span></p>
                    <p class="payment-detail">Total Price: $<span id="total-price">100</span></p>
                    <hr>
                    <span class="card-icon"><img class="card-icon" src="https://yaronkadstorage.blob.core.windows.net/publiccontainer/izzycheckout/credit_cards.png" alt="DEBIT/CREDIT CARD INFORMATION"> Debit/Credit Card information</span>
                    <div id="recurly-elements"></div>

                    <input type="hidden" name="plan_code" value="{{PlanCode}}">
                    <input type="hidden" name="recurly-token" id="recurly-token">

                    <!--v2-->
                    <!--<div class="g-recaptcha" data-sitekey="6LfkorwmAAAAAFH8P7a6gcj_atOdLZE8coTX_7XC"></div>-->
                    <button type="submit">SUBSCRIBE & START WATCHING NOW</button>
                </form>
            </div>

            <div class="col-lg-6" id="description-titles" style="color: white;">
                <h3 class="title-text" style="margin-bottom: 30px;">Unlock {{content_hours}} of Israeli Entretainment!</h3>
                <span class="card-icon"><img class="card-icon" src="/imgages/blue-check-mark-correct-tick-16238.svg" alt="DEBIT/CREDIT CARD INFORMATION" style="vertical-align: middle; width: 22px; margin-top: -6px; padding: 2px; margin-right: 5px;"><strong style="font-size: 22px; color: #7fcef1;">Discover a World of Stories:</strong></span>     
                <h6 class="title-descriptions" style="margin-left: 27px;">Explore israeli films, documentaries, and TV shows with fresh new content every week.</h6>  
                 </br>
                 <span class="card-icon"><img class="card-icon" src="/imgages/blue-check-mark-correct-tick-16238.svg" alt="DEBIT/CREDIT CARD INFORMATION" style="vertical-align: middle; width: 22px; margin-top: -6px; padding: 2px; margin-right: 5px;"><strong style="font-size: 22px; color: #7fcef1;">Languages That Speak to You:</strong></span>     
                <h6 class="title-descriptions" style="margin-left: 27px;">Enjoy English subtitles on all content, with many titles available in Spanish, Portuguese, and French.</h6>
                </br>
                <span class="card-icon"><img class="card-icon" src="/imgages/blue-check-mark-correct-tick-16238.svg" alt="DEBIT/CREDIT CARD INFORMATION" style="vertical-align: middle; width: 22px; margin-top: -6px; padding: 2px; margin-right: 5px;"><strong style="font-size: 22px; color: #7fcef1;">Accessible Everywhere:</strong></span>    
                <h6 class="title-descriptions" style="margin-left: 27px;">Watch on any device, from Apple and Android to Amazon, Roku, Tizen, and more.</h6>
                </br>
                <span class="card-icon"><img class="card-icon" src="/imgages/blue-check-mark-correct-tick-16238.svg" alt="DEBIT/CREDIT CARD INFORMATION" style="vertical-align: middle; width: 22px; margin-top: -6px; padding: 2px; margin-right: 5px;"><strong style="font-size: 22px; color: #7fcef1;">Effortless Viewing:</strong></span>  
                <h6 class="title-descriptions" style="margin-left: 27px;">Get started in no time with a simple and easy setup.</h6>
                </br>
                <span class="card-icon"><img class="card-icon" src="/imgages/blue-check-mark-correct-tick-16238.svg" alt="DEBIT/CREDIT CARD INFORMATION" style="vertical-align: middle; width: 22px; margin-top: -6px; padding: 2px; margin-right: 5px;"><strong style="font-size: 22px; color: #7fcef1;">Worldwide Access:</strong></span>  
                <h6 class="title-descriptions" style="margin-left: 27px;">Join the IZZY community, no matter where you are.</h6>
                </br>
                <span class="card-icon"><img class="card-icon" src="/imgages/blue-check-mark-correct-tick-16238.svg" alt="DEBIT/CREDIT CARD INFORMATION" style="vertical-align: middle; width: 22px; margin-top: -6px; padding: 2px; margin-right: 5px;"><strong style="font-size: 22px; color: #7fcef1;">Regional Taxes:</strong></span>  
                <h6 class="title-descriptions" style="margin-left: 27px;">Please note that taxes may apply based on your location.</h6> 
                </div>
             </div>
        

            <!--
    <div class="col-lg-6">
        <h3 class="title-text">Unlock {{content_hours}} of Israeli Entretainment!</h3>
         <ul class="side-text">
            <h4>Discover a Worls of Stories:</h4>
            <h6 class="title-descriptions">Explore israeli films, documentaries, and TV shows with fresh new content every week.</h6>
         </br>
            <h4>Languages That Speak to You::</h4>
            <h6 class="title-descriptions">Enjoy English subtitles on all content, with many titles available in Spanish, Portuguese, and French.</h6>
        </br>
            <h4>Accessible Everywhere:</h4>
            <h6 class="title-descriptions">Watch on any device, from Apple and Android to Amazon, Roku, Tizen, and more.</h6>
        </br>
            <h4>Effortless Viewing:</h4>
            <h6 class="title-descriptions">Get started in no time with a simple and easy setup.</h6>
        </br>
            <h4>Worldwide Access:</h4>
            <h6 class="title-descriptions">Join the IZZY community, no matter where you are.</h6>
        </br>
            <h4>Regional Taxes:</h4>
            <h6 class="title-descriptions">Please note that taxes may apply based on your location.</h6>
        </ul>
    </div>
    -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://js.recurly.com/v4/recurly.js"></script>
    <!--For izzy production-->
    <!--<script src="https://yaronkadstorage.blob.core.windows.net/publiccontainer/izzycheckout/script.js"></script>-->
    <!--For yaronkad test-->
    <script src="https://yaronkadstorage.blob.core.windows.net/publiccontainer/izzycheckout/script-test-env.js"></script>
    <script>
        //const originalPrice = 100; // Replace with your dynamic price logic
        document.getElementById('apply-coupon').addEventListener('click', async () => {
            const originalPrice = dollarToDecimal(document.getElementById('original-price').textContent);;
            const couponInput = document.getElementById('coupon');
            const couponMessage = document.getElementById('coupon-message');
            const discountElement = document.getElementById('discount');
            const totalPriceElement = document.getElementById('total-price');

            const couponCode = couponInput.value;

            if (!couponCode) {
                couponMessage.textContent = "Please enter a coupon code.";
                couponMessage.style.color = "red";
                return;
            }

            try {
                // Send the coupon to the backend for validation
                const response = await fetch('/api/izzycheckoutapi/validate', {
                //const response = await fetch('/api/coupons/validate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ couponCode })
                });

                const result = await response.json();
                if (response.ok) {
                    const discount = (originalPrice * result.discount) / 100;
                    const totalPrice = originalPrice - discount;

                    // Update UI
                    couponMessage.textContent = "Coupon applied successfully!";
                    couponMessage.style.color = "green";
                    discountElement.textContent = discount.toFixed(2);
                    totalPriceElement.textContent = totalPrice.toFixed(2);
                } else {
                    couponMessage.textContent = result.message || "Invalid coupon code.";
                    couponMessage.style.color = "red";
                    discountElement.textContent = "0";
                    totalPriceElement.textContent = originalPrice.toFixed(2);
                }
            } catch (error) {
                couponMessage.textContent = "An error occurred while validating the coupon.";
                couponMessage.style.color = "red";
                discountElement.textContent = "0";
                totalPriceElement.textContent = originalPrice.toFixed(2);
            }
        });

        function dollarToDecimal(dollarString) {
            // Remove the dollar sign and commas
            const cleanedString = dollarString.replace(/[$,]/g, '');
            // Convert the cleaned string to a number
            return parseFloat(cleanedString);
        }

        // field validations

      /*  const form = document.getElementById('payment-form');
        const city = document.getElementById('city');
    
        form.addEventListener('submit', e => {
        e.preventDefault();

        validateInputs();
    });

        const setError = (element, message) => {
        const inputControl = element.parentElement;
        const errorDisplay = inputControl.querySelector('.error');

            errorDisplay.innerText = message;
            inputControl.classList.add('error');
            inputControl.classList.remove('success')
    }   

        const setSuccess = element => {
        const inputControl = element.parentElement;
        const errorDisplay = inputControl.querySelector('.error');

            errorDisplay.innerText = '';
            inputControl.classList.add('success');
            inputControl.classList.remove('error');
    };

        const isValidEmail = email => {
        const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
    }

        const validateInputs = () => {
        const cityValue = city.value.trim(); 
  
      if(city === '') {
        setError(city, 'City is required');
        } else {
        setSuccess(city);
        }
};*/
    </script>
</body>
</html>
